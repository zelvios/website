<main class="snap-container">
    <section class="relative overflow-hidden z-10 pt-35 md:pt-40 xl:pt-45 snap-section" id="home">
        <div class="max-w-7xl mx-auto">
            <div class="absolute -z-10 pointer-events-none inset-0 overflow-hidden -mx-28">
                <div class="absolute -z-1 -top-[128%] sm:-top-[107%] xl:-top-[73%] left-1/2 -translate-x-1/2 hero-circle-gradient w-full h-[1282px] rounded-full max-w-[1282px]"></div>
                <div class="absolute -z-1 -top-[112%] sm:-top-[93%] xl:-top-[62%] left-1/2 -translate-x-1/2 hero-circle-gradient w-full h-[1046px] rounded-full max-w-[1046px]"></div>
                <div class="absolute top-0 left-1/2 -translate-x-1/2 -u-z-100">
                    <img alt="blur" class="max-w-none" src="./images/blur/blur-02.svg"/>
                </div>
                <div class="absolute top-0 left-1/2 -translate-x-1/2 -u-z-100">
                    <img alt="blur" class="max-w-none" src="./images/blur/blur-01.svg"/>
                </div>
            </div>
        </div>

        <div class="flex flex-col items-center justify-center space-y-7 mt-[12vh] md:mt-[12vh]">
            <div class="w-auto text-center fade-in">
                <h1 class="text-6xl font-bold bg-gradient-to-r from-white to-accent bg-clip-text text-transparent">
                    Jacob Jørgensen
                </h1>

                <div class="flex justify-center gap-4 mt-4">
                    <a href="https://github.com/zelvios" rel="noopener noreferrer" target="_blank">
                        <button class="flex items-center gap-2 cursor-pointer text-white text-sm font-medium bg-gradient-to-r from-gray-800 to-black px-4 py-2 rounded-full border border-gray-600 hover:scale-105 duration-200 hover:text-accent hover:border-gray-800 hover:from-black hover:to-gray-900">
                            <svg height="18" viewBox="0 0 24 24" width="18" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
                                      fill="#FFFFFF"/>
                            </svg>
                            Github
                        </button>
                    </a>
                    <a href="https://www.linkedin.com/in/jacob-j-in/" rel="noopener noreferrer" target="_blank">
                        <button class="flex items-center gap-2 cursor-pointer text-white text-sm font-medium bg-gradient-to-r from-gray-800 to-black px-4 py-2 rounded-full border border-gray-600 hover:scale-105 duration-200 hover:text-accent hover:border-gray-800 hover:from-black hover:to-gray-900">
                            <svg fill="#FFFFFF" height="18" viewBox="0 0 24 24" width="18"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path d="M4.98 3.5C4.98 4.88 3.87 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM.5 24h4V7H.5v17zM8.5 7H12v2.5h.06c.49-.92 1.7-1.9 3.44-1.9 3.68 0 4.5 2.42 4.5 5.57V24h-4v-8.17c0-1.95-.03-4.47-2.72-4.47-2.73 0-3.15 2.13-3.15 4.33V24h-4V7z"/>
                            </svg>
                            LinkedIn
                        </button>
                    </a>
                </div>

                <div class="max-w-prose mx-auto mt-16">
                    <p class="text-md text-text mt-3 text-center" style="line-height: 1.5;">
                        I’m a computer technician student specializing in programming, studying in Aalborg, Denmark.
                        I focus on building reliable software and continuously developing my technical skills. You can
                        check out my projects, contributions, and experiments in full-stack development on GitHub.
                    </p>
                </div>
            </div>

            <div class="relative group fade-in">
                <a class="relative inline-block p-px font-semibold leading-6 text-text bg-base shadow-lg cursor-pointer rounded-2xl shadow-accent transition-all duration-300 ease-in-out hover:scale-105 active:scale-95 hover:shadow-accent"
                   href="#part2"
                   id="to-section-2">
                    <span class="absolute inset-0 rounded-2xl bg-gradient-to-r from-accent via-text to-surface1 p-[2px] opacity-0 transition-opacity duration-500 group-hover:opacity-100"></span>
                    <span class="relative z-10 block px-6 py-3 rounded-2xl bg-base">
                        <div class="relative z-10 flex items-center space-x-3">
                            <span class="transition-all duration-500 group-hover:translate-x-1.5 group-hover:text-accent">Begin Journey</span>
                            <svg class="w-7 h-7 transition-all duration-500 group-hover:translate-y-1.5 group-hover:text-accent rotate-90"
                                 fill="currentColor" viewBox="0 0 24 24">
                                <path d="M16.172 11l-5.364-5.364 1.414-1.414L20 12l-7.778 7.778-1.414-1.414L16.172 13H4v-2z"></path>
                            </svg>
                        </div>
                    </span>
                </a>
            </div>
        </div>

        <div class="w-auto fade-in mt-20 mb-0 flex justify-center">
            <img alt="Tab Icon" class="mx-auto" src="/images/tab.svg"/>
        </div>
    </section>

    <!-- PART 2 Projects -->
    <section
            class="snap-section flex flex-row items-center justify-center bg-base text-text relative overflow-x-hidden space-x-8 px-8 w-full"
            id="part2">
        {#if loadError}
            <div class="max-w-md min-w-[200px] px-4 text-center">
                <p class="text-accent font-semibold text-xl">
                    Sorry, could not load GitHub projects at the moment.
                </p>
                <p class="text-text mt-2 text-base">
                    Please try again later.
                </p>
            </div>
        {:else if repos.length === 0}
            <div class="text-center text-slate-400 text-lg">
                Loading projects…
            </div>
        {:else}
            <div class="overflow-x-auto no-scrollbar">
                <div class="flex items-center space-x-6 px-4 pb-4">

                    <div class="relative flex-none max-w-md min-w-[200px] pl-6">
                        <!-- Gradient Line -->
                        <div class="absolute left-0 top-0 h-full w-[1px] bg-gradient-to-b from-accent to-white mt-2 mb-2"></div>

                        <!-- Content -->
                        <div>
                            <a href="/projects" class="block no-underline">
                                <h1 class="text-6xl font-bold bg-gradient-to-r from-accent to-white bg-clip-text text-transparent">
                                    Projects
                                </h1>
                                <p class="text-md text-text mt-4">
                                    My workflow is primarily managed on GitHub. Here are some of my featured projects;
                                    feel free to
                                    explore the full collection by clicking the “Projects” tab or the button below.
                                </p>
                            </a>
                            <a href="/projects">
                                <button class="mt-5 relative px-10 py-2.5 rounded-xl bg-zinc-900 text-text font-bold tracking-widest uppercase text-sm border-b-4 border-accent/50 hover:border-accent transition-all duration-300 ease-in-out hover:text-accent shadow-[0_10px_20px_rgba(203,166,247,0.15)] hover:shadow-[0_15px_30px_rgba(203,166,247,0.25)] active:border-b-0 active:translate-y-1">
                                    <span class="flex items-center gap-3 relative z-10">
                                        View All
                                    <svg viewBox="0 0 24 24" fill="currentColor"
                                         class="w-5 h-5 transition-all duration-300 group-hover:translate-x-1">
                                        <path d="M12 4L10.6 5.4L16.2 11H4V13H16.2L10.6 18.6L12 20L20 12L12 4Z"></path>
                                    </svg>
                                    </span>
                                    <div class="absolute -inset-1 rounded-xl bg-gradient-to-br from-accent/20 to-accent0/20 blur-2xl group-hover:blur-xl transition-all duration-300 -z-10 opacity-0 group-hover:opacity-100"></div>
                                </button>
                            </a>
                        </div>
                    </div>


                    {#each repos as repo}
                        <div class="group relative flex-none w-[380px] min-w-0 mb-10">
                            <div class="relative overflow-hidden rounded-2xl bg-slate-950 shadow-2xl transition-all duration-300 hover:-translate-y-1 hover:shadow-accent/15">

                                <div class="absolute -left-16 -top-16 h-32 w-32 rounded-full bg-gradient-to-br from-indigo-500/20 to-purple-500/0 blur-2xl transition-all duration-500 group-hover:scale-150 group-hover:opacity-70"></div>
                                <div class="absolute -right-16 -bottom-16 h-32 w-32 rounded-full bg-gradient-to-br from-purple-500/20 to-indigo-500/0 blur-2xl transition-all duration-500 group-hover:scale-150 group-hover:opacity-70"></div>

                                <div class="relative p-6">
                                    <div class="absolute right-6 top-6">
                                        <img src="./images/projects.svg"
                                             alt="Project Icon"
                                             class="h-12 w-12 text-indigo-500/10"/>
                                    </div>

                                    <!-- title & desc -->
                                    <div class="mt-4 space-y-2">
                                        <a href={repo.html_url}
                                           target="_blank"
                                           rel="noopener noreferrer"
                                           class="block hover:underline">
                                            <h3 class="text-xl font-semibold text-white">{repo.name}</h3>

                                            <img src={`https://raw.githubusercontent.com/Zelvios/${repo.name}/main/.github/screenshots/design.png`}
                                                 alt="Project screenshot"
                                                 class="mt-4 rounded-lg w-full h-40 object-cover"/>
                                        </a>

                                        <p class="repo-desc text-slate-400 mt-2">
                                            {repo.description ?? 'No description provided.'}
                                        </p>
                                    </div>

                                    <!-- languages -->
                                    <div class="rounded-xl bg-slate-900/50 p-4 mt-4">
                                        <div class="flex items-center gap-2">
                                            <span class="text-sm font-medium text-white">Most Used Languages</span>
                                        </div>

                                        {#if repo.topLanguages === null}
                                            <p class="mt-1 text-xs text-slate-400 italic">Loading…</p>
                                        {:else if repo.topLanguages.length > 0}
                                            <p class="mt-1 text-xs text-slate-400">
                                                {repo.topLanguages.join(', ')}
                                            </p>
                                        {:else}
                                            <p class="mt-1 text-xs text-slate-400">—</p>
                                        {/if}
                                    </div>

                                    <!-- gitHub link & created date -->
                                    <div class="mt-6 flex items-center justify-between">
                                        <div class="flex items-center gap-2">
                                            <a href={repo.html_url}
                                               target="_blank"
                                               rel="noopener noreferrer"
                                               class="rounded-lg bg-slate-900 p-2 text-slate-400 transition-colors hover:text-white"
                                               aria-label={`Go to ${repo.name} GitHub repository`}>
                                                <!-- gitHub icon SVG -->
                                                <svg class="h-5 w-5"
                                                     fill="currentColor"
                                                     viewBox="0 0 24 24"
                                                     aria-hidden="true">
                                                    <path fill-rule="evenodd"
                                                          clip-rule="evenodd"
                                                          d="M12 0C5.372 0 0 5.373 0 12c0 5.303 3.438 9.8 8.207 11.387.6.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.09-.745.083-.729.083-.729 1.205.084 1.838 1.237 1.838 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.31.469-2.381 1.236-3.22-.124-.304-.536-1.524.117-3.176 0 0 1.008-.322 3.301 1.23a11.484 11.484 0 013.003-.404c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.872.118 3.176.77.839 1.235 1.91 1.235 3.22 0 4.609-2.807 5.625-5.479 5.921.43.372.823 1.103.823 2.223v3.293c0 .319.192.694.801.576C20.565 21.796 24 17.3 24 12c0-6.627-5.373-12-12-12z"/>
                                                </svg>
                                            </a>
                                        </div>
                                        <span class="text-sm text-slate-400"> Updated: {formatDate(repo.updated_at)} </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {/each}
                </div>
            </div>
        {/if}

        <span class="absolute bottom-0 left-0 w-full"
              style="height: 30vh; overflow: hidden;">
            <img alt="grid"
                 class="w-full h-full object-cover"
                 src="./images/grid.svg"/>
        </span>

        <a aria-label="Go to Part 1"
           class="absolute bottom-8 right-8 p-3 rounded-full bg-surface1 text-accent shadow-lg hover:bg-accent-dark transition-colors flex items-center justify-center"
           href="#home"
           id="to-section-1"
           style="width: 48px; height: 48px;">
            <svg class="w-6 h-6 -rotate-90 transition-transform"
                 fill="none"
                 stroke="currentColor"
                 stroke-width="2"
                 viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M9 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </a>
    </section>
</main>

<style>
    html, body {
        margin: 0;
        height: 100%;
        overflow: hidden;
    }

    .snap-container {
        height: 100vh;
        overflow-y: auto;
        scroll-snap-type: y mandatory;
        scroll-behavior: smooth;
    }

    .snap-section {
        scroll-snap-align: start;
        height: 100vh;
    }

    .fade-in {
        animation: fadeIn 1s ease-out;
    }

    @keyframes fadeIn {
        0% {
            opacity: 0;
            transform: translateY(20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>

<script>
    import {afterUpdate, onMount, tick} from 'svelte';

    onMount(() => {
        const begin = document.getElementById('to-section-2');
        if (begin) {
            begin.addEventListener('click', () => {
                setTimeout(() => history.replaceState(null, '', ' '), 10);
            });
        }

        const back = document.getElementById('to-section-1');
        if (back) {
            back.addEventListener('click', () => {
                setTimeout(() => history.replaceState(null, '', ' '), 10);
            });
        }
    });

    const staticProjects = [
        'dotfiles',
        'todo-tui',
        'BashControlCenter'
    ];

    let loadError = false;
    let repos = [];

    onMount(async () => {
        try {
            const res = await fetch('https://api.github.com/users/Zelvios/repos');
            if (!res.ok) throw new Error(res.statusText);
            const data = await res.json();

            repos = data
                .filter(r => staticProjects.includes(r.name))
                .sort((a, b) =>
                    staticProjects.indexOf(a.name)
                    - staticProjects.indexOf(b.name)
                );

            await Promise.all(repos.map(async repo => {
                repo.topLanguages = null;

                try {
                    const langRes = await fetch(
                        `https://api.github.com/repos/Zelvios/${repo.name}/languages`
                    );
                    if (!langRes.ok) throw new Error(langRes.statusText);
                    const langs = await langRes.json();
                    repo.topLanguages = Object.entries(langs)
                        .sort((a, b) => b[1] - a[1])
                        .slice(0, 5)
                        .map(([lang]) => lang);
                } catch {
                    repo.topLanguages = [];
                }

                repos = [...repos];
            }));

            loadError = false;

        } catch (e) {
            console.error('Could not load repos:', e);
            loadError = true;
        }
    });

    function formatDate(iso) {
        return new Date(iso).toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
        });
    }

    afterUpdate(async () => {
        await tick();

        const descs = Array.from(document.querySelectorAll('.repo-desc'));
        if (!descs.length) return;

        const maxH = descs.reduce((mx, el) => Math.max(mx, el.offsetHeight), 0);

        descs.forEach(el => {
            el.style.minHeight = `${maxH}px`;
        });
    });
</script>